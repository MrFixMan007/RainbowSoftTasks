<!DOCTYPE HTML>
<html>
 <head>
  <meta charset="utf-8">
  <title>Директория</title>
  <link rel="stylesheet" href="/static/styles/style.css">
 </head>
 <body>
  <div>
    <p><input type="text" id="root" placeholder="Введите адрес" size="50dp"> <button id="myButton">Перейти</button></p>
    <p><input type="checkbox" id="sortType" checked="checked" >Cортировка по возрастанию</p>
  </div>
  <div id="unswers"></div>

<script type="text/javascript">

  myButton.addEventListener('click', getDir);
  getDir()

  function getDir(root = "/") {
    rootInInput = document.getElementById('root').value
    if(rootInInput != "" && rootInInput != null){
      root = rootInInput;
    }

    sortType = document.getElementById('sortType')

    let xhr = new XMLHttpRequest();
    let url = new URL('http://{{.Host}}/dir');
    
    url.searchParams.set('root', root);
    if(document.getElementById('sortType').checked == true){
      url.searchParams.set('sortType', 'asc');
    }
    else url.searchParams.set('sortType', 'desc');

    xhr.open('GET', url);
    xhr.send();
    i = 0;

    xhr.onload = function() {
      unmarshFiles = JSON.parse(xhr.response);

      const divUnswers = document.getElementById('unswers');
      divUnswers.innerHTML = "";

      for (let i = 0; i < unmarshFiles.length; i++){
        var divSrc = document.createElement("div");
        divSrc.id = 'unswer' + i;
        divSrc.className = "unswer"
        divUnswers.appendChild(divSrc);

        divSrc.textContent = unmarshFiles[i].Type + " " + unmarshFiles[i].Name + " " + unmarshFiles[i].Size;
      }
    };

    xhr.onerror = function() { 
      alert(`[Ошибка соединения]`);
    };
  };
    
  //sortType.addEventListener('click', checkSortTypeRadioButton)
</script>
 </body>
</html>